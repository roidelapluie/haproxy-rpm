From 7cd526913ad9066827ff7f22ee8838eeb482bd24 Mon Sep 17 00:00:00 2001
From: Julien Pivotto <roidelapluie@inuits.eu>
Date: Wed, 13 Jan 2021 00:17:33 +0100
Subject: [PATCH] Revert "BUG/MINOR: dns: SRV records ignores duplicated AR
 records"

This reverts commit 8461b9ea7882fc9ca3436316c3ae6a1d01b23085.
---
 src/dns.c | 5 -----
 1 file changed, 5 deletions(-)

diff --git a/src/dns.c b/src/dns.c
index 02c5ea239..c38152d7f 100644
--- a/src/dns.c
+++ b/src/dns.c
@@ -955,10 +955,6 @@ static int dns_validate_dns_response(unsigned char *resp, unsigned char *bufend,
 				dns_answer_record->data_len = len;
 				memcpy(dns_answer_record->target, tmpname, len);
 				dns_answer_record->target[len] = 0;
-				if (dns_answer_record->ar_item != NULL) {
-					pool_free(dns_answer_item_pool, dns_answer_record->ar_item);
-					dns_answer_record->ar_item = NULL;
-				}
 				break;
 
 			case DNS_RTYPE_AAAA:
@@ -1208,7 +1204,6 @@ static int dns_validate_dns_response(unsigned char *resp, unsigned char *bufend,
 			// looking for the SRV record in the response list linked to this additional record
 			list_for_each_entry(tmp_record, &dns_p->answer_list, list) {
 				if (tmp_record->type == DNS_RTYPE_SRV &&
-				    tmp_record->ar_item == NULL &&
 				    !dns_hostname_cmp(tmp_record->target, dns_answer_record->name, tmp_record->data_len)) {
 					/* Always use the received additional record to refresh info */
 					if (tmp_record->ar_item)
-- 
2.28.0

